<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>

    <link href="css/StyleDefult.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <script src="scripts/jquery-3.3.1.js"></script>
    <script src="scripts/bootstrap.min.js"></script>

    <script type="text/javascript" src="cordova.js"></script>
    <script src="scripts/database.js"></script>
    <script src="scripts/index.js"></script>
    
    <script type="text/javascript">
        var id = 0;

        document.addEventListener("deviceready", onDeviceReady, false);

        function onDeviceReady() {
            id = getUrlVars()["id"];
            console.log("Device ready! InterviewID:", window.localStorage["InterviewID"]);
            
            var checkDB = setInterval(function() {
                if (typeof db !== 'undefined' && db !== null) {
                    clearInterval(checkDB);
                    LoadData();
                }
            }, 100);
        }

        window.onload = function () {
            id = getUrlVars()["id"];
        };

        function LoadData() {
            console.log("LoadData çağrıldı");
            db.transaction(function (tx) {
                var sqlQuery = "SELECT SES25S1 FROM INTERVIEWS WHERE InterviewID=" + window.localStorage["InterviewID"];
                console.log("SQL sorgusu:", sqlQuery);
                
                tx.executeSql(sqlQuery, [], 
                    function (tx, val) {
                        console.log("SQL başarılı, satır sayısı:", val.rows.length);
                        if (val.rows.length > 0) {
                            var row = val.rows.item(0);
                            console.log("Row data:", row);
                            
                            if (row.SES25S1) {
                                $('input[name="SES25S1"][value="' + row.SES25S1 + '"]').prop('checked', true);
                            }
                        } else {
                            console.log("Hiç satır bulunamadı");
                        }
                    },
                    function(tx, error) {
                        console.error("SQL hatası:", error.message);
                    });
            });
        }

        function getUrlVars() {
            var vars = [], hash;
            var indexofHash = window.location.href.indexOf('#');
            var hashes;
            if (indexofHash == -1) {
                hashes = window.location.href.slice((window.location.href.indexOf('?')) + 1).split('&');
            } else {
                hashes = window.location.href.slice((window.location.href.indexOf('#')) + 1).split('&');
            }
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }

        function gecisKontrol() {
            var secilenDeger = $('input[name="SES25S1"]:checked').val();
            
            if (!secilenDeger) {
                alert("Lütfen bir seçenek seçiniz!");
                return;
            }
            
            var updateStr = "SES25S1='" + secilenDeger + "'";
            
            myUpdateRedirect("INTERVIEWS", updateStr, " InterviewID=" + window.localStorage["InterviewID"], "SES25S2.html?id=" + window.localStorage["InterviewID"]);
        }

        function goBack() {
            window.history.back();
        }
    </script>
</head>
<body>
    <form id="form1">
        <table border="0" id="QuestionText">
            <tbody>
                <tr>
                    <td>
                        <span id="StepNameTD">SES25S1.</span>
                        <span id="QuestionTextTD">
                            <font face="calibri" color="#000000" size="2">
                                <b>Haneye asıl geliri getiren kişinin en son bitirdiği okulu öğrenebilir miyiz?</b>
                            </font>
                            <p align="left">
                                <font face="calibri" color="#000000" size="2">
                                    <i>Bu kişi hanede yaşayan ve hanenin geçiminden sorumlu olanlar arasında hane giderlerine en yüksek katkıyı sağlayandır. Hanedeki en yaşlı ya da en söz sahibi kişi olmayabilir. Bu kişi kendisi çalışmıyor fakat dışarıdan maaş, destek vb. alıyor da olabilir. Hane bir öğrenci evi ise öğrencilerden hangisi tarafından (kendisi ya da ailesi) en çok gelir sağlanıyorsa o seçilmelidir.</i>
                                </font>
                            </p>
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <div id="QuestionBuilderPanel">
            <table id="QuestionTable" class="cssQuestionTable">
                <tbody>
                    <tr class="AlternateTableRow">
                        <td class="columnDivider"></td>
                        <td align="right">1</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_1" value="1">
                        </td>
                        <td>
                            <label for="SES25S1_1">Okuma Yazma Bilmiyor</label>
                        </td>
                    </tr>
                    <tr>
                        <td class="columnDivider"></td>
                        <td align="right">2</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_2" value="2">
                        </td>
                        <td>
                            <label for="SES25S1_2">İlkokul Terk</label>
                        </td>
                    </tr>
                    <tr class="AlternateTableRow">
                        <td class="columnDivider"></td>
                        <td align="right">3</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_3" value="3">
                        </td>
                        <td>
                            <label for="SES25S1_3">İlkokul Mezunu</label>
                        </td>
                    </tr>
                    <tr>
                        <td class="columnDivider"></td>
                        <td align="right">4</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_4" value="4">
                        </td>
                        <td>
                            <label for="SES25S1_4">Ortaokul Mezunu</label>
                        </td>
                    </tr>
                    <tr class="AlternateTableRow">
                        <td class="columnDivider"></td>
                        <td align="right">5</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_5" value="5">
                        </td>
                        <td>
                            <label for="SES25S1_5">Anadolu Lisesi veya Düz Lise Mezunu</label>
                        </td>
                    </tr>
                    <tr>
                        <td class="columnDivider"></td>
                        <td align="right">6</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_6" value="6">
                        </td>
                        <td>
                            <label for="SES25S1_6">Meslek Lisesi Mezunu</label>
                        </td>
                    </tr>
                    <tr class="AlternateTableRow">
                        <td class="columnDivider"></td>
                        <td align="right">7</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_7" value="7">
                        </td>
                        <td>
                            <label for="SES25S1_7">Yüksek Okul (2 Yıllık)</label>
                        </td>
                    </tr>
                    <tr>
                        <td class="columnDivider"></td>
                        <td align="right">8</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_8" value="8">
                        </td>
                        <td>
                            <label for="SES25S1_8">Açıköğretim Üniversite</label>
                        </td>
                    </tr>
                    <tr class="AlternateTableRow">
                        <td class="columnDivider"></td>
                        <td align="right">9</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_9" value="9">
                        </td>
                        <td>
                            <label for="SES25S1_9">Üniversite (4 Yıllık)</label>
                        </td>
                    </tr>
                    <tr>
                        <td class="columnDivider"></td>
                        <td align="right">10</td>
                        <td align="right">
                            <input type="radio" class="radioStyle" name="SES25S1" id="SES25S1_10" value="10">
                        </td>
                        <td>
                            <label for="SES25S1_10">Yüksek Lisans</label>
                        </td>
                    </tr>
                    
                    <tr>
                        <td colspan="2">
                            <input type="button" value="Geri" onclick="goBack();" />
                            <input type="button" value="Durum Kodla" onclick="javascript: window.location.href = 'ResponseKodu.html';" />
                        </td>
                        <td colspan="2" align="right">
                            <input type="button" id="next" name="next" value="İleri" onclick="gecisKontrol();" />
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </form>
</body>
</html>